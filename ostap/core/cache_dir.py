#!/usr/bin/env python
# -*- coding: utf-8 -*-
# =============================================================================
## @file cache_dir.py
#  @author Vanya BELYAEV Ivan.Belyaev@itep.ru
#  @date 2014-03-10
# =============================================================================
""" Cache directory for ostap 
""" 
# =============================================================================
__author__  = "Vanya BELYAEV  Ivan.Belyaev@itep.ru"
__date__    = "2014-03-10"
__version__ = "$Revision$"
__all__     = (
    'cache_dir' , ## work/cache directory
)
# =============================================================================
import ostap.core.config as     config
import os
# =============================================================================
cache_dir = config.cache_dir 
# =============================================================================
if cache_dir : # ==============================================================
    # =========================================================================
    cache_dir = os.path.expandvars ( cache_dir )
    cache_dir = os.path.expanduser ( cache_dir )
    cache_dir = os.path.expandvars ( cache_dir )
    cache_dir = os.path.expanduser ( cache_dir )
    # =========================================================================
    if not os.path.exists ( cache_dir ): # ====================================
        # =====================================================================
        try : # ===============================================================
            # =================================================================
            os.makedirs ( cache_dir , exist_ok = True ) 
            # =================================================================
        except OSError : # ====================================================
            # =================================================================
            cache_dir = None 

# =============================================================================
if not cache_dir                    or \
   not os.path.exists ( cache_dir ) or \
   not os.path.isdir  ( cache_dir ) or \
   not os.access      ( cache_dir , os.W_OK ) : 
    # =========================================================================
    from ostap.utils.cleanup import CleanUp
    cache_dir = CleanUp.tempdir ( prefix = 'ostap-cache-' ) 
    
# =============================================================================
if '__main__' == __name__ : 
    
    from ostap.logger.logger import getLogger 
    logger = getLogger ( 'ostap.core.cache_dir'  )
    
    # =============================================================================
    from ostap.utils.docme import docme    
    docme ( __name__ , logger = logger )
    
# =============================================================================
##                                                                      The END 
# =============================================================================
